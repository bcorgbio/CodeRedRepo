---
title: "CodeRed_Module7"
author: "Liz Asprinio, Tingwei Hu, James Kim, Justin Lau"
date: "2022-11-27"
output: html_document
bibliography: BIOL3140_m7.bib
nocite: '@*'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
```

```{r, packages, include=FALSE}
library(tidyverse)
library(knitr)
library(MuMIn)
```

# Introduction

The muscle force-length relationship is governed by several factors. One aspect is the number of crossbridges formed in the regions of actin-myosin overlap of a sarcomere, which is directly related to the maximum amount of isometric force that can be produced by the muscle. Another aspect is mechanical advantage, the ratio between input (L_i) and output (L_o) force:
				$$MA = L_i/L_o$$
Greater mechanical advantage is described by a smaller ratio, or moving a load using a relatively small force. In the human body, this concept is illustrated by bones and joints acting as levers and pivots to minimize the force required by muscles to move a load. The arm is a lever and has a mechanical advantage of 0.2. However, the insertion angle of the muscles changes as the forearm flexes, which also contributes to output force. This complicates the study of force-length relationships, but research has shown that output force is sufficient to determine force-length relationships in input muscles (@rassier1999length).
In this project, the force-length relationship in the human arm and its response to fatigue will be studied. Isometric force-angle curves for the human forearm flexors undertaking maximum voluntary contractions (MVCs) will be constructed, and the angles at which maximum isometric force (Fmax) occur (Î¸max) between non-fatigued (i.e., control) and eccentrically fatigued forearm flexors will be compared.Research has shown that the force-length/angle relationship shifts after eccentric fatigue, and the underlying mechanisms of this shift will be discussed.
last few sentences r exactly from his writing so ill fix them up


# Methods
Still under construction.
Maximum isometric voluntary contraction force was measured for each subject (n=34) at 11-12 different elbow angles (range:45 to 157.5 degrees, in varying increments) for both fatigue and control conditions. Fatigue was considered reached after performing 3 minutes of continuous isokinetic controlled drops of a heavy object, which weights >=1/3 of maximum isometric force in control experiment. Both the control and fatigue experiments were conducted on the same arm in each respective subject. 
We first normalized isometric force in each subject by representing the force at each angle as a fraction of the highest force measured in that subject under the same condition. 
```{r, Read files and data tidying,message=FALSE}
dat.f <- list.files(path="./Project8_data") #pls don't move the data folder

dat.l <- list()

for(i in dat.f){
  metadata <- unlist(strsplit(i,'_'))
  subj <- metadata[2]
  ang <- metadata[3]
  exp <- gsub('.csv','',metadata[4])
  trial.force <- read_csv(paste0('Project8_data/',i),col_names=FALSE)
  trial.force$X1 <- gsub("[a-zA-Z :]","",trial.force$X1)
  mvcf <- trial.force %>% 
    pull(X1) %>% 
    as.numeric() %>% 
    mean()
  dat.l[[i]] <- tibble(
    subject=subj,
    ang=as.numeric(ang),
    exp=exp,
    force=mvcf
  )
}
dat <- do.call(rbind,dat.l)
dat.p <- dat %>% #processing all the data
  group_by(exp,subject) %>% 
  mutate(force=force/max(force)) %>% 
  print() #sanity check

#This took an ungodly amount of time to figure out...
```

# Results
```{r, plotting data}
dat.p %>%
  na.omit() %>% 
  ggplot(aes(ang,force,col=exp))+geom_point() #visualize
```

# Discussion



# Author Contribution
Tingwei Hu - Doc setup, read files, plot initial data, methods



# References